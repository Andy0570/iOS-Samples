> 原文：<https://github.com/robbiehanson/CocoaAsyncSocket/wiki/Intro>

## Introduction to Sockets

如果你是网络初学者，这里便是起点。使用 socket 和使用文件是非常不同的，尽管 API 可能是相似的。对网络基础知识的理解上做一点投资会有很大的帮助。而且从长远来看，它可以为你节省很多时间，并防止产生挫败感。

我们将保持简短，并限定于开发人员所关注的东西：只是开发人员完成目标所需的内容，同时不会跳过重要的基础知识，以免日后造成问题。

## Sockets, Ports, and DNS - Oh My!

在网络术语中，一台计算机是有许多 socket 套接字的主机。一个套接字是通信通道的一端，称为网络连接；另一端是另一个套接字。从自身的角度来说，任何一个套接字都是本地套接字，而连接另一端的套接字就是远程套接字。

要建立连接，两个 sockets 中的一个必须与另一个取得联系。要想取得联系，该套接字必须知道另一个套接字的地址。每个 socket 都有一个地址。地址由两部分组成：主机地址和端口号。主机地址是计算机的 IP 地址，端口号是唯一标识计算机上托管的每个套接字的唯一标识。

一台计算机可以有多个主机地址，因为它可以有多个网络接口。例如，一台计算机可能配备了以太网卡、调制解调器、WiFi 卡、VPN 连接、蓝牙等。而除了这些之外，还有一个特殊的接口用于连接自己（称为 "loopback"，有时也称为 "localhost"）。

像 "google.com" 这样的地址对应的是一个主机地址，但它本身并不是一个主机地址。它是一个 DNS 条目或 DNS 名称，通过 DNS 查询操作转换为主机地址。我们可以把 DNS 想象成一本电话簿。如果你想给某人打电话，但不知道他的号码，你可以在电话簿中查询以获得他们的号码。他们的名字与电话号码相匹配。同样，DNS 将一个名字（如 "google.com"）与一个 IP 地址相匹配。

## Networking Huh?

问题的关键是你要进行通信的网络不可靠。也许你要通过互联网发送数据出去。也许要通过 WiFi，或者通过蜂窝网络发送。也可能是通过卫星发送到太空。你可能甚至不知道。

但让我们假设一下，你确实知道。让我们假设你知道所有的通信都将在一个封闭的商业网络中，通过常规的以太网进行。通信将是100%可靠的，对吗？错了。我指的也不是断线或断电。

所有被发送或接收的数据都会被分解成小数据包。这些数据包会被传送到网络上，然后到达路由器，路由器必须决定它们的去向。但在流量爆发时，路由器可能会被数据包超载。数据包进来的速度超过了路由器对它们的路由选择。会发生什么？同样的事情，每天在世界各地发生数百万次：路由器开始丢包。

除了在网络上丢失数据包外，接收电脑也可能被迫丢包。也许是计算机超载，或者接收应用程序从操作系统读取数据的速度不够快。还有一种可能是数据包在传输过程中被破坏了，也许是电干扰造成的。而这一切还没有涉及到 WiFi 或互联网等引入的其他问题。

如果你是网络新手，你可能会想，一切都能像它一样好用，这是一个奇迹。事实上，这个奇迹来自于过去几十年来完善的网络协议，以及理解它们并有效使用它们的开发人员。(那就是你！)

## Bring on the Protocols

你可能可以列出几十个与计算机网络有关的协议。

HTTP, FTP, XMPP, POP, IMAP, SMTP, DHCP, DNS, VoIP, SIP, RTP, RTCP, ...

但这些协议中的每一个都是在另一个协议的基础上分层的，为它处理网络问题。这些低层协议处理了大部分网络方面的问题，这样应用层协议（上面列出的那些协议）就可以专注于应用方面。

上面列出的 "应用层协议" 是建立在 "传输层协议" 层之上的。而在上面列出的所有协议中，只有两个传输层协议。TCP 和 UDP。

## UDP

用户数据报协议（UDP）是两者中比较简单的一种。你只能把少量的数据放到 UDP 数据包中，然后你就把它送过去。然后......就是这样。不能保证消息会到达。如果你连续发送多个数据包，也不能保证它们会按顺序到达。看起来很不可靠，不是吗？但它的弱点也是它的优势。如果你要发送时间敏感的数据，比如 VoIP 通话中的音频，那么你不希望你的传输协议浪费时间重传丢失的数据包，因为丢失的音频无论如何都会太晚到达，无法播放。事实上，流媒体音频和视频是 UDP 的一些最大用途。

UDP 还有一个优势，它不需要 "握手连接"。你可以这样想。如果你坐在火车上，你想和旁边的陌生人进行长时间的交谈，你可能会从介绍开始。比如说："你要去哪里？哦，是的，我也在往那个方向走。我叫罗比，你叫什么名字？" 但如果你只是想知道时间，那么你可以跳过介绍。你不会被要求告诉陌生人你的名字。你可以直接说，"对不起，你有时间吗？" 陌生人可以很快地回答，你们就可以继续做你们正在做的事情了。这就是为什么像 DNS 这样的协议会基于 UDP 协议。这样你的电脑就可以说："打扰一下，请问 google.com 的 IP 是多少？" 而服务器可以快速响应。

## TCP

传输控制协议（TCP）可能是你使用最多的协议。无论你是在浏览网页、查看电子邮件，还是向朋友发送即时信息，你可能都在使用TCP。

TCP 是为 "长对话" 而设计的。所以有一个初始的连接握手步骤，之后数据可以在必要的时间内来回流动。但 TCP 的伟大之处在于，它的设计是为了在面对不可靠的网络时，让通信变得可靠。所以它为我们做了各种非常酷的事情。如果你通过 TCP 发送一些信息，而其中一部分丢失了，协议会自动找出丢失的信息并重新发送。而当你发送信息时，TCP 会确保信息总是以正确的顺序到达。但是，等等，还有更多! 该协议还会检测到网络中的拥堵情况，并相应地自动调整规模，让每个人都能共享。

所以，使用 TCP 有很多很好的理由，它很适合很多网络任务。另外，通过 TCP 发送的数据量是没有限制的。它被设计成一个开放的数据流，向两个或多个方向流动。只是由应用层来决定这些数据是什么样子的。

## Where do we fit in?

那么...UDP 和 TCP...我们如何使用它们？CocoaAsyncSocket 库提供的就是这些吗？TCP 和 UDP 的实现？不，不完全是。正如你可以想象的那样，TCP 和 UDP 被到处使用。所以它们自然是由操作系统提供的。如果你打开你的终端，输入 "man socket"，你可以看到底层的 BSD socket API。这些库本质上是位于低级套接字 API 之上的封装器，并为您，开发者，提供了一个易于使用的 Objective-C 框架。

因此，CocoaAsyncSocket 提供了一个伟大的 API，为您简化了网络。但是联网仍然很棘手，所以我们建议你在开始之前阅读以下内容。



